/*
ID: varunra2
LANG: C++
TASK: a
*/

#include <bits/stdc++.h>
using namespace std;

#ifdef DEBUG
#include "lib/debug.h"
#define debug(...) cerr << "[" << #__VA_ARGS__ << "]:", debug_out(__VA_ARGS__)
#define debug_arr(...) \
  cerr << "[" << #__VA_ARGS__ << "]:", debug_arr(__VA_ARGS__)
#pragma GCC diagnostic ignored "-Wsign-compare"
//#pragma GCC diagnostic ignored "-Wunused-parameter"
//#pragma GCC diagnostic ignored "-Wunused-variable"
#else
#define debug(...) 42
#endif

#define EPS 1e-9
#define IN(A, B, C) assert(B <= A && A <= C)
#define INF (int)1e9
#define MEM(a, b) memset(a, (b), sizeof(a))
#define MOD 1000000007
#define MP make_pair
#define PB push_back
#define all(cont) cont.begin(), cont.end()
#define rall(cont) cont.end(), cont.begin()
#define x first
#define y second

const double PI = acos(-1.0);
typedef long long ll;
typedef long double ld;
typedef pair<int, int> PII;
typedef map<int, int> MPII;
typedef multiset<int> MSETI;
typedef set<int> SETI;
typedef set<string> SETS;
typedef vector<int> VI;
typedef vector<PII> VII;
typedef vector<VI> VVI;
typedef vector<string> VS;

#define rep(i, a, b) for (int i = a; i < (b); ++i)
#define trav(a, x) for (auto& a : x)
#define sz(x) (int)(x).size()
typedef pair<int, int> pii;
typedef vector<int> vi;
#pragma GCC diagnostic ignored "-Wsign-compare"
// util functions

int calc(VI& a, VI& b) {
  // int ret = 0;
  // int p1 = 0;
  // for (int i = 0; i < sz(a); i++) {
  //   while (p1 < sz(b) and b[p1] < a[i]) p1++;
  //   if (p1 < sz(b) and b[p1] == a[i]) ret++;
  // }
  // return sz(a) - ret;
  MPII ma, mb;
  trav(x, a) ma[x]++;
  trav(x, b) mb[x]++;
  int ret = 0;
  trav(x, ma) ret += min(ma[x.x], mb[x.x]);
  return sz(a) - ret;
}

int solve() {
  int n, m;
  cin >> n >> m;
  // debug("new tc", n, m);
  VI s(m);
  trav(x, s) cin >> x;
  VVI vals(n, VI(m));
  trav(x, vals) { trav(y, x) cin >> y; }

  int tot = 0;
  VI prv = s;

  for (int i = 0; i < n; i++) {
    int cur = calc(prv, vals[i]);
    tot += cur;
    prv = vals[i];
  }

  // how many can wear a dress underneath

  vector<MPII> cnt(n + 1);

  for (int i = 0; i < n; i++) {
    for (int j = 0; j < m; j++) {
      cnt[i + 1][vals[i][j]]++;
    }
  }

  for (int i = 0; i < m; i++) {
    cnt[0][s[i]]++;
  }

  int same = 0;

  for (auto& x : cnt[0]) {
    int ret = 0;
    for (int i = 1; i <= n; i++) {
      ret += max(0, cnt[i - 1][x.x] - cnt[i][x.x]);
    }
    tot -= min(ret, x.y);
  }

  return tot;
}

int main() {
#ifndef ONLINE_JUDGE
  freopen("a.in", "r", stdin);
  freopen("a.out", "w", stdout);
#endif
  cin.sync_with_stdio(0);
  cin.tie(0);

  int t;
  cin >> t;

  for (int i = 1; i <= t; i++) {
    cout << "Case #" << i << ": " << solve() << '\n';
  }

  return 0;
}
